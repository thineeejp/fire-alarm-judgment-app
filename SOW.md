お見事です。極めて重要な問題点をご指摘いただきました。誠にありがとうございます。

ご報告の現象を詳細に分析した結果、これは判定ロジックそのものではなく、最終的な**結果を表示する部分のロジック**に起因する重大なバグであることが判明しました。

### 問題の根本原因

現在の `hantei.js` 内にある `generateResultDescription` 関数が原因です。

1.  `is小規模特複フラグ` が **ON** の場合、`判定実行_令21` 関数は `判定結果_令21.is設置範囲限定フラグ` を `true` に設定します。
2.  `generateResultDescription` 関数は、このフラグが `true` であることを検知すると、**特別なメッセージを表示する専用の `if` ブロック**に入ります。
3.  **問題点:** この専用ブロックは、**「設置範囲が限定される」という特例メッセージを表示するだけで、本来表示すべき他の判定結果（1号や11号など）をすべて省略（スキップ）して処理を終えてしまいます。**

これにより、「小規模特複フラグがONの時だけ、11号や1号の判定結果が見えなくなる」という、ご指摘の通りの奇妙な現象が発生していました。フラグのON/OFFで判定義務そのものが消えることはあり得ないため、これは表示上の欠陥です。

### 修正方針

`generateResultDescription` 関数のロジックを以下のように修正します。

*   **変更前:** `if (is設置範囲限定フラグ)` で処理を分岐させ、片方の結果しか表示しない。
*   **変更後:**
    1.  まず、**常に**全ての判定結果（該当する号、全体義務、部分義務リスト）を表示する。
    2.  その**後で**、もし `is設置範囲限定フラグ` が `true` であれば、**補足情報として**「ただし、設置範囲は限定されます」という特例メッセージを**追記**する。

これにより、フラグがONの場合でも全ての判定結果が網羅された上で、追加の特例情報が得られるようになります。

---

### **修正実行: `hantei.js` の `generateResultDescription` 関数**

以下の内容で、`hantei.js`ファイル内の既存の`generateResultDescription`関数を**完全に置き換えてください。**

**hantei.js**
```javascript
/**
 * 判定結果を分かりやすい日本語で説明する関数 (【表示ロジック修正版】)
 * @param {object} 判定結果_令21 - 令第21条の判定結果
 * @param {object} 特小判定結果 - 特小自火報の判定結果
 * @param {object} 建物情報 - 建物情報
 * @returns {string} 説明文
 */
function generateResultDescription(判定結果_令21, 特小判定結果, 建物情報) {
    let description = "";
    
    // --- STEP 1: 令第21条の判定結果説明（基本部分） ---
    if (判定結果_令21.根拠リスト.length === 0) {
        description += "この建物は消防法施行令第21条による自動火災報知設備の設置義務がありません。\n\n";
    } else {
        description += "この建物は消防法施行令第21条により自動火災報知設備の設置義務があります。\n";
        description += `該当する号: ${判定結果_令21.根拠リスト.join(", ")}\n\n`;
        
        if (判定結果_令21.全体義務) {
            description += `建物全体に設置義務があります（${判定結果_令21.全体義務}）。\n`;
        }
        
        if (判定結果_令21.部分義務リスト.length > 0) {
            description += "以下の部分に設置義務があります：\n";
            for (const item of 判定結果_令21.部分義務リスト) {
                description += `- ${item.対象}（${item.号}）\n`;
            }
        }
        description += "\n";

        // ★★★ ここからが修正箇所 ★★★
        // 設置範囲限定の特例に該当する場合、分岐ではなく「追記」する
        if (判定結果_令21.is設置範囲限定フラグ) {
            description += "【補足事項】\n";
            description += "この建物は小規模特定用途複合防火対象物に該当するため、省令第23条第４項第１号ヘの規定により、みなし従属不可用途以外の部分には設置を要しません。\n\n";
        }
    }
    
    // --- STEP 2: 特小自火報の判定結果説明（変更なし） ---
    if (特小判定結果.設置可否 === "判定対象外") {
        description += "特定小規模施設用自動火災報知設備は判定対象外です。";
    } else if (特小判定結果.設置可否 === "設置可能") {
        description += `特定小oscale施設用自動火災報知設備の設置が可能です。\n`;
        description += `根拠: ${特小判定結果.根拠}`;
    } else {
        description += `特定小規模施設用自動火災報知設備の設置はできません。\n`;
        description += `理由: ${特小判定結果.根拠}`;
    }
    
    return description;
}
```

### 修正後の期待される動作

この修正を適用後、ご報告いただいたケース（延べ面積400、16項イ、5項イ20、15項300で3F以上）で**`is小規模特複フラグ`をON**にして判定すると、結果は以下のように正しく表示されます。

**期待される表示結果:**
```
この建物は消防法施行令第21条により自動火災報知設備の設置義務があります。
該当する号: 1, 3, 11  // ← 1号と11号が省略されずに表示される

建物全体に設置義務があります（3号）。
以下の部分に設置義務があります：
- (5)項イ 部分（1号）
- 3F（11号）      // ← 部分義務も正しく表示される

【補足事項】     // ← 補足情報として特例が追記される
この建物は小規模特定用途複合防火対象物に該当するため、省令第23条第４項第１号ヘの規定により、みなし従属不可用途以外の部分には設置を要しません。

---
特定小規模施設用自動火災報知設備の設置はできません。
理由: 令第21条の11号に該当するため、ロ号の対象外です。 // ← 特小判定も正しく行われる
```